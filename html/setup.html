<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Setup - Photobook</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles.css">
</head>
<body class="setup-body">

    <!-- Setup Screen -->
    <div class="setup-screen-modern">
        <!-- Header -->
        <div class="setup-header-modern">
            <button class="btn-back" onclick="window.location.href='index.html'">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h1 class="header-title">Setup</h1>
            <div class="header-spacer"></div>
        </div>

        <!-- Content -->
        <div class="setup-content-modern">
            <!-- Progress -->
            <div class="setup-progress">
                <div class="progress-step active">
                    <div class="step-dot"></div>
                    <span>Book Details</span>
                </div>
                <div class="progress-line"></div>
                <div class="progress-step">
                    <div class="step-dot"></div>
                    <span>Upload Photos</span>
                </div>
                <div class="progress-line"></div>
                <div class="progress-step">
                    <div class="step-dot"></div>
                    <span>Design</span>
                </div>
            </div>

            <h2 class="section-heading">Configure Your Photobook</h2>
            <p class="section-subheading">Set up the basic properties of your photo book</p>

            <!-- Book Settings Card -->
            <div class="settings-card">
                <div class="card-label">
                    <i class="fas fa-layer-group"></i>
                    <span>Book Settings</span>
                </div>

                <div class="form-group">
                    <label class="input-label">Number of Pages</label>
                    <input type="number" class="form-input" id="numPages" min="1" max="100" value="10" placeholder="10">
                </div>

                <div class="form-group">
                    <label class="input-label">Orientation</label>
                    <select class="form-input" id="orientation">
                        <option value="landscape">üì± Landscape (Horizontal)</option>
                        <option value="portrait">üì± Portrait (Vertical)</option>
                        <option value="square">‚óºÔ∏è Square</option>
                    </select>
                </div>
            </div>

            <!-- Layout Style Card -->
            <div class="settings-card">
                <div class="card-label">
                    <i class="fas fa-th-large"></i>
                    <span>Layout Style</span>
                </div>

                <div class="layout-grid-modern">
                    <div class="layout-option active" data-layout="classic">
                        <div class="layout-icon-wrapper">
                            <i class="fas fa-square-full"></i>
                        </div>
                        <div class="layout-info">
                            <div class="layout-title">Classic</div>
                            <div class="layout-description">One large photo per page</div>
                        </div>
                        <div class="layout-check">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>

                    <div class="layout-option" data-layout="modern">
                        <div class="layout-icon-wrapper">
                            <i class="fas fa-th-large"></i>
                        </div>
                        <div class="layout-info">
                            <div class="layout-title">Modern</div>
                            <div class="layout-description">Two photos side by side</div>
                        </div>
                        <div class="layout-check">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>

                    <div class="layout-option" data-layout="collage">
                        <div class="layout-icon-wrapper">
                            <i class="fas fa-grip"></i>
                        </div>
                        <div class="layout-info">
                            <div class="layout-title">Collage</div>
                            <div class="layout-description">Multiple photos in grid</div>
                        </div>
                        <div class="layout-check">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>

                    <div class="layout-option" data-layout="minimal">
                        <div class="layout-icon-wrapper">
                            <i class="fas fa-square"></i>
                        </div>
                        <div class="layout-info">
                            <div class="layout-title">Minimal</div>
                            <div class="layout-description">Clean and elegant</div>
                        </div>
                        <div class="layout-check">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom CTA -->
        <div class="setup-footer-modern">
            <button class="btn-primary-large" id="startBtn">
                Continue
                <i class="fas fa-arrow-right ms-2"></i>
            </button>
        </div>
    </div>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        let selectedLayout = 'classic';

        // Layout selection
        document.querySelectorAll('.layout-option').forEach(card => {
            card.addEventListener('click', function() {
                document.querySelectorAll('.layout-option').forEach(c => c.classList.remove('active'));
                this.classList.add('active');
                selectedLayout = this.getAttribute('data-layout');
            });
        });

        // Start designing
        document.getElementById('startBtn').addEventListener('click', function() {
            const numPages = parseInt(document.getElementById('numPages').value) || 10;
            const orientation = document.getElementById('orientation').value;
            const btn = this;

            if (numPages < 1 || numPages > 100) {
                alert('Please enter a valid number of pages (1-100)');
                return;
            }

            // Show loading state
            btn.disabled = true;
            btn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span> Creating your book...';

            // Save settings to localStorage
            const bookData = {
                numPages: numPages,
                orientation: orientation,
                layout: selectedLayout,
                photoLibrary: [],
                pages: []
            };

            // Initialize pages with enhanced structure
            for (let i = 0; i < numPages; i++) {
                bookData.pages.push({
                    id: 'page_' + i,
                    images: [],
                    caption: '',
                    backgroundColor: '#ffffff',
                    layoutMode: 'grid',
                    gridTemplate: '2x2',
                    gridRows: 2,
                    gridCols: 2,
                    gridSpacing: 20,
                    gridPadding: 40,
                    textBlocks: [],
                    elements: [],
                    bgPattern: 'none',
                    imageColumns: selectedLayout === 'classic' ? 1 : selectedLayout === 'modern' ? 2 : 3,
                    imageSpacing: 20
                });
            }

            localStorage.setItem('bookData', JSON.stringify(bookData));
            localStorage.setItem('currentPageIndex', '0');

            // Navigate to upload page with slight delay for UX
            setTimeout(() => {
                window.location.href = 'upload.html';
            }, 500);
        });

        // Add keyboard support
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && !e.target.matches('input, textarea')) {
                document.getElementById('startBtn').click();
            }
        });
    </script>
</body>
</html>
